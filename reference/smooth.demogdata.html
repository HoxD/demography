<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create smooth demogdata functions — smooth.demogdata • demography</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create smooth demogdata functions — smooth.demogdata"><meta property="og:description" content="Smooth demogdata data using one of four methods depending on the value of method"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">demography</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.22.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/robjhyndman/demography/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create smooth demogdata functions</h1>
    <small class="dont-index">Source: <a href="https://github.com/robjhyndman/demography/blob/HEAD/R/smooth.R" class="external-link"><code>R/smooth.R</code></a></small>
    <div class="hidden name"><code>smooth.demogdata.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Smooth demogdata data using one of four methods depending on the value of <code>method</code></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smooth.demogdata</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  method <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">type</span>, mortality <span class="op">=</span> <span class="st">"mspline"</span>, fertility <span class="op">=</span> <span class="st">"cspline"</span>, migration <span class="op">=</span></span>
<span>    <span class="st">"loess"</span><span class="op">)</span>,</span>
<span>  <span class="va">age.grid</span>,</span>
<span>  power <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">type</span>, mortality <span class="op">=</span> <span class="fl">0.4</span>, fertility <span class="op">=</span> <span class="fl">1</span>, migration <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">65</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  span <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  interpolate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  weight <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">type</span> <span class="op">!=</span> <span class="st">"migration"</span>,</span>
<span>  obs.var <span class="op">=</span> <span class="st">"empirical"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>Demogdata object such as created using <code><a href="read.demogdata.html">read.demogdata</a></code>.</p></dd>


<dt>method</dt>
<dd><p>Method of smoothing. Possibilities: <code>"mspline"</code> (monotonic regression splines),
<code>"cspline"</code> (concave regression splines),
<code>"spline"</code> (unconstrained regression splines),
<code>"loess"</code> (local quadratic using <code><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></code>).</p></dd>


<dt>age.grid</dt>
<dd><p>Ages to use for smoothed curves. Default is single years over a slightly greater range than the unsmoothed data.</p></dd>


<dt>power</dt>
<dd><p>Power transformation for age variable before smoothing. Default is 0.4 for mortality data and 1 (no transformation) for fertility or migration data.</p></dd>


<dt>b</dt>
<dd><p>Lower age for monotonicity if <code>method=="mspline"</code>. Above this, the smooth curve
is assumed to be monotonically increasing.</p></dd>


<dt>k</dt>
<dd><p>Number of knots to use for penalized regression spline estimate. Ignored if <code>method=="loess"</code>.</p></dd>


<dt>span</dt>
<dd><p>Span for loess smooth if <code>method=="loess"</code>.</p></dd>


<dt>lambda</dt>
<dd><p>Penalty for constrained regression spline if <code>method=="cspline"</code>.</p></dd>


<dt>interpolate</dt>
<dd><p>If <code>interpolate==TRUE</code>, a linear interpolation is used instead of smoothing.</p></dd>


<dt>weight</dt>
<dd><p>If TRUE, uses weighted smoothing.</p></dd>


<dt>obs.var</dt>
<dd><p>Method for computing observational variance. Possible values: “empirical” or “theoretical”.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Demogdata object identical to <code>data</code> except all
rate matrices are replaced with smooth versions and pop matrices are replaced with disaggregated population estimates obtained
using monotonic spline interpolation applied to the cumulative population data.
Weight
matrices are also added to the object showing the inverse
variances of the estimated smooth curves.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The value of <code>method</code> determines the type of smoothing used.</p><dl><dt>method="mspline"</dt>
<dd><p>Weighted penalized regression splines with a monotonicity constraint. The curves are monotonically
      increasing for age greater than b. Smoothness controlled by <code>k</code>. Methodology based on Wood (1994). Code calls <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> for the basic
      computations.</p></dd>

    <dt>method="cspline"</dt>
<dd><p>Weighted regression B-splines with a concavity constraint. Smoothness controlled by <code>lambda</code>.
      Methodology based on He and Ng (1999). Code calls <code><a href="https://rdrr.io/pkg/cobs/man/cobs.html" class="external-link">cobs</a></code> for the basic computations.</p></dd>

    <dt>method="spline"</dt>
<dd><p>Unconstrained weighted penalized regression splines. Equivalent to "mspline" but with <code>b=Inf</code>.</p></dd>

    <dt>method="loess"</dt>
<dd><p>Weighted locally quadratic regression. Smoothness controlled by span. Code calls
      <code><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></code> for the basic computations.</p></dd>

  
</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Rob J Hyndman</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">france.sm</span> <span class="op">&lt;-</span> <span class="fu">smooth.demogdata</span><span class="op">(</span><span class="fu"><a href="extract.years.html">extract.years</a></span><span class="op">(</span><span class="va">fr.mort</span>,<span class="fl">1980</span><span class="op">:</span><span class="fl">1997</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">france.sm</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="smooth.demogdata-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fr.mort</span>,years<span class="op">=</span><span class="fl">1980</span>,type<span class="op">=</span><span class="st">"p"</span>,pch<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">france.sm</span>,years<span class="op">=</span><span class="fl">1980</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="smooth.demogdata-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rob Hyndman.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

